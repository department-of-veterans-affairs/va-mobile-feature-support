flowchart TD
    Start([Veteran Opens VA Mobile App]) --> Auth{Authenticated?}
    
    Auth -->|No| Login[Initiate Login Process]
    Login --> SSOe[Authenticate via SSOe]
    SSOe --> AuthSuccess{Login Successful?}
    AuthSuccess -->|No| AuthError[Display Authentication Error]
    AuthError --> End1([End])
    AuthSuccess -->|Yes| NavToVHIC
    
    Auth -->|Yes| NavToVHIC[Navigate to VHIC Section]
    
    NavToVHIC --> CheckCard[Check Local Data Store for Digital VHIC]
    CheckCard --> HasCard{Digital VHIC Found?}
    
    HasCard -->|No| NoCard[Display No Digital VHIC Card Found]
    NoCard --> RequestCard[Show Request Digital VHIC Button]
    RequestCard --> RedirectVHIC[Redirect to VHIC Self Service Portal]
    RedirectVHIC --> End2([End])
    
    HasCard -->|Yes| ValidateCard[Validate Card Data]
    ValidateCard --> CardValid{Card Data Valid?}
    
    CardValid -->|No| InvalidCard[Display Card Data Invalid Error]
    InvalidCard --> RefreshCard[Show Refresh Card Option]
    RefreshCard --> End3([End])
    
    CardValid -->|Yes| DisplayCard[Display Digital VHIC Card]
    DisplayCard --> CardActions[Show Card Actions]
    
    CardActions --> WalletOption[Add to Wallet Option]
    CardActions --> RefreshOption[Refresh Card Option]
    
    WalletOption --> AddWallet{Add to Wallet Selected?}
    AddWallet -->|Yes| WalletFlow[Initiate Wallet Integration]
    WalletFlow --> WalletSuccess{Wallet Add Successful?}
    WalletSuccess -->|Yes| WalletConfirm[Show Added to Wallet Confirmation]
    WalletSuccess -->|No| WalletError[Show Failed to Add to Wallet Error]
    WalletConfirm --> End4([End])
    WalletError --> End5([End])
    
    AddWallet -->|No| End6([End])
    RefreshOption --> CheckCard
    
    classDef startEnd fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
    classDef process fill:#e3f2fd,stroke:#2196f3,stroke-width:2px  
    classDef decision fill:#fff3e0,stroke:#ff9800,stroke-width:2px
    classDef error fill:#ffebee,stroke:#f44336,stroke-width:2px
    classDef success fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
    
    class Start,End1,End2,End3,End4,End5,End6 startEnd
    class Login,SSOe,NavToVHIC,CheckCard,ValidateCard,DisplayCard,CardActions,WalletFlow process
    class Auth,AuthSuccess,HasCard,CardValid,AddWallet,WalletSuccess decision
    class AuthError,NoCard,InvalidCard,WalletError error
    class WalletConfirm success